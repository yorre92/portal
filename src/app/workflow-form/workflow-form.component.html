<div>
  <h3>Workflow</h3>
</div>

<form [formGroup]="form">
  <mat-form-field>
    <input matInput placeholder="Name" formControlName="name" />
  </mat-form-field>
  <mat-form-field>
    <input matInput placeholder="Description" formControlName="description" />
  </mat-form-field>

  <div>
    <h3>Steps</h3>
    <p>Design ur workflow.</p>
  </div>
  <mat-vertical-stepper formArrayName="steps" [linear]="true" #stepper>
    <mat-step
      [stepControl]="1"
      *ngFor="let s of steps.controls; let i = index"
      [formGroupName]="i"
    >
      <ng-template matStepLabel>{{ s.controls.type.value }}</ng-template>
      <mat-form-field>
        <mat-select required placeholder="Type" formControlName="type">
          <mat-option *ngFor="let step of stepTypes" [value]="step.value">
            {{ step.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <div
        style="width: 700px;"
        *ngIf="s.controls.type.value === 'httprequest'"
      >
        <app-api-call-form [form]="s.controls.request"></app-api-call-form>
      </div>
    </mat-step>
  </mat-vertical-stepper>

  <div></div>
</form>
<button mat-raised-button [disabled]="form.invalid" (click)="save()">
  save
</button>
